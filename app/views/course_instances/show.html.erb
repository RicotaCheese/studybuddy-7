<h1>
  <strong><%= @course_instance.course.school.school_name %></strong>
</h1>

<h2>
  <strong><%= @course_instance.course.course_code %>: <%= @course_instance.course.course_name %></strong> - <%= @course_instance.year %> <%= @course_instance.semester %>
</h2>


<h3>Notes</h3>

<% if @course_instance.notes.empty? %>
  <p>There is no notes yet. Be the first to contribute to the course :)</p>

<% else %>

<table>
  <tr>
    <th>Title</th>
    <th>Created By</th>
    <th>Rating</th>
    <th>Delete</th>
  </tr>
 
  <% @course_instance.notes.each do |note| %>
    <tr>
      <td><%= link_to note.title, [note.course_instance, note], action: "show"  %></td>
      <td><%= "#{note.user.first_name} #{note.user.last_name}" %></td>
      <td><%= note.ave_rating %></td>
      <% if note.user.id == current_user.id%>
        <td><%= link_to "Delete Note", [note.course_instance, note], 
                        method: :delete, 
                        data: {confirm: "Are you sure?"} %></td>
      <% end %>
    </tr>
  <% end %>
</table>

<% end %>

<h3>Add a note</h3>
  <%= form_with(model: [ @course_instance, @course_instance.notes.build ], local: true) do |form| %>
    <p>
      <%= form.label :title %><br>
      <%= form.text_field :title, :required => true%>
    </p>
    <p>
      <%= form.label :body %><br>
      <%= form.text_area :body %>
    </p>

    <p>Attach a File</p>
    <p>
      <%= form.file_field :file %>
    </p>

    <p>
      <%= form.submit %>
    </p>
  <% end %>

<p><%= link_to "return", course_path(@course_instance.course) %></p>